# BYR_Achieve
考核题目
`写完这个题目之后竟然一时间不知道说什么，这应该算是我做过有史以来最大的题目（本人零基础小白）`
### 背景
拿到这个题目的时候是一脸懵逼的，根本看不懂说的什么，然后就下定决心看了2个小时的全栈开发视频。看完之后呢，就了解到这题需要用JavaScript+Node写。~~此时仍然是看不懂题目的，不太了解npm registry以及package.json的结构（甚至后面发现这个json里头有个tarballUrl)~~
~~面向ai编程（bushi~~
## 总体结构
解析请求->访问元数据package.json并获取tarballUrl->解析入口文件并返回内容/返回目录/直接返回相应文件内容

##### 1请求解析
这里使用了match来正则匹配路径，把请求分为了三个部分（包名，版本，文件路径）。正则匹配规则的生成用ai做的。
##### 1.1版本解析
正则匹配到的为版本请求，按照请求处理版本。当访问https://registry.npmjs.org/包名，就会返回所有版本的package元数据，其中有版本列表以及dist-tags，获取之后查找，这里使用了semver库来查找对应版本。()
##### 2请求解析
当正则匹配到的文件路径不是空也不是’/‘时就是一个完整文件的相对路径。如果是’/‘就返回文件目录，如果都不是（为空）时就是返回入口文件。
##### 3tarball的拉取解压
因为这一部分完全没有接触过，就使用了ai来生成（后面在ai的指导下看懂了，学到了XD）。这个部分是用流管道pipeline和tar库来实现的。先将响应体转化为可读流，然后解压tarball，然后分chunk提取需要的数据，输出
##### 3.1文件列表的获取
与上一部分同理，但是忽略了文件的内容，只获取根目录的文件的文件路径。
我觉得3和3.1可以合并就是了，没时间改了（关于参考https://semver.npmjs.com/我只看到了他拉取了一个很大的json，里面包含了版本列表，也许他也是这么实现的吧XD）
### 其他细节
	文件类型的识别用魔数检测（直接ai的）
	遇到的问题的话，match的正则匹配出现了很多次bug，让ai调了半天，还有一些bug解决之后我就忘记了（
	全程用到的ai是联想小天（电脑自带的，并不好用）
### 未完成方向
缓存
文件的层级结构
更好的路径匹配
减少重复的代码（造成了重复的访问）
